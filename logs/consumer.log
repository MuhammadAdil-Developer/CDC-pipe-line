2025-03-15 00:02:51,127 - __main__ - INFO - Consumer shutting down
2025-03-15 00:02:51,131 - __main__ - INFO - Database connection closed
2025-03-15 00:02:51,135 - kafka.coordinator - INFO - Stopping heartbeat thread
2025-03-15 00:02:51,136 - kafka.coordinator - INFO - Leaving consumer group (cdc-processor).
2025-03-15 00:02:51,142 - kafka.conn - INFO - <BrokerConnection node_id=coordinator-1 host=localhost:9092 <connected> [IPv4 ('127.0.0.1', 9092)]>: Closing connection. 
2025-03-15 00:02:51,144 - kafka.conn - INFO - <BrokerConnection node_id=1 host=localhost:9092 <connected> [IPv4 ('127.0.0.1', 9092)]>: Closing connection. 
2025-03-15 00:02:51,145 - kafka.consumer.fetcher - ERROR - Fetch to node 1 failed: Cancelled: <BrokerConnection node_id=1 host=localhost:9092 <connected> [IPv4 ('127.0.0.1', 9092)]>
2025-03-15 00:02:51,145 - __main__ - INFO - Kafka consumer closed
2025-03-15 00:02:51,146 - py4j.clientserver - INFO - Closing down clientserver connection
2025-03-15 00:02:53,481 - kafka.conn - INFO - <BrokerConnection node_id=bootstrap-0 host=localhost:9092 <connecting> [IPv4 ('127.0.0.1', 9092)]>: connecting to localhost:9092 [('127.0.0.1', 9092) IPv4]
2025-03-15 00:02:53,481 - kafka.conn - INFO - Probing node bootstrap-0 broker version
2025-03-15 00:02:53,482 - kafka.conn - INFO - <BrokerConnection node_id=bootstrap-0 host=localhost:9092 <connecting> [IPv4 ('127.0.0.1', 9092)]>: Connection complete.
2025-03-15 00:02:53,584 - kafka.conn - INFO - Broker version identified as 2.6.0
2025-03-15 00:02:53,584 - kafka.conn - INFO - Set configuration api_version=(2, 6, 0) to skip auto check_version requests on startup
2025-03-15 00:02:53,585 - kafka.consumer.subscription_state - INFO - Updating subscribed topics to: ('cdc-events',)
2025-03-15 00:02:53,586 - __main__ - INFO - Connected to Kafka, consuming from topic: cdc-events
2025-03-15 00:02:53,589 - kafka.cluster - INFO - Group coordinator for cdc-processor is BrokerMetadata(nodeId='coordinator-1', host='localhost', port=9092, rack=None)
2025-03-15 00:02:53,590 - kafka.coordinator - INFO - Discovered coordinator coordinator-1 for group cdc-processor
2025-03-15 00:02:53,590 - kafka.coordinator - INFO - Starting new heartbeat thread
2025-03-15 00:02:53,590 - kafka.coordinator.consumer - INFO - Revoking previously assigned partitions set() for group cdc-processor
2025-03-15 00:02:53,591 - kafka.conn - INFO - <BrokerConnection node_id=coordinator-1 host=localhost:9092 <connecting> [IPv4 ('127.0.0.1', 9092)]>: connecting to localhost:9092 [('127.0.0.1', 9092) IPv4]
2025-03-15 00:02:53,592 - kafka.conn - INFO - <BrokerConnection node_id=coordinator-1 host=localhost:9092 <connecting> [IPv4 ('127.0.0.1', 9092)]>: Connection complete.
2025-03-15 00:02:53,592 - kafka.conn - INFO - <BrokerConnection node_id=bootstrap-0 host=localhost:9092 <connected> [IPv4 ('127.0.0.1', 9092)]>: Closing connection. 
2025-03-15 00:02:53,693 - kafka.coordinator - INFO - (Re-)joining group cdc-processor
2025-03-15 00:02:56,697 - kafka.coordinator - INFO - Elected group leader -- performing partition assignments using range
2025-03-15 00:02:56,698 - kafka.conn - INFO - <BrokerConnection node_id=1 host=localhost:9092 <connecting> [IPv4 ('127.0.0.1', 9092)]>: connecting to localhost:9092 [('127.0.0.1', 9092) IPv4]
2025-03-15 00:02:56,699 - kafka.conn - INFO - <BrokerConnection node_id=1 host=localhost:9092 <connecting> [IPv4 ('127.0.0.1', 9092)]>: Connection complete.
2025-03-15 00:02:56,701 - kafka.coordinator - INFO - Successfully joined group cdc-processor with generation 27
2025-03-15 00:02:56,701 - kafka.consumer.subscription_state - INFO - Updated partition assignment: [TopicPartition(topic='cdc-events', partition=0)]
2025-03-15 00:02:56,701 - kafka.coordinator.consumer - INFO - Setting newly assigned partitions {TopicPartition(topic='cdc-events', partition=0)} for group cdc-processor
2025-03-15 00:03:16,591 - __main__ - INFO - Received event: 785caabc-8efe-459c-b152-f3281be06507 of type update
2025-03-15 00:03:16,601 - __main__ - INFO - Processed event 785caabc-8efe-459c-b152-f3281be06507 of type update
2025-03-15 00:03:23,152 - __main__ - ERROR - Error with Delta processing: Failed to create Spark session
2025-03-15 00:03:23,152 - __main__ - INFO - Falling back to parquet storage
2025-03-15 00:03:23,206 - __main__ - INFO - Saved event data to parquet: ./data/parquet/123/balance/so-financials_20250315000323.parquet
2025-03-15 00:03:23,207 - __main__ - INFO - Received event: 1264b225-c215-4f3f-bcc3-93592481fe0b of type update
2025-03-15 00:03:23,214 - __main__ - INFO - Processed event 1264b225-c215-4f3f-bcc3-93592481fe0b of type update
2025-03-15 00:03:27,850 - __main__ - ERROR - Error with Delta processing: Failed to create Spark session
2025-03-15 00:03:27,850 - __main__ - INFO - Falling back to parquet storage
2025-03-15 00:03:27,882 - __main__ - INFO - Saved event data to parquet: ./data/parquet/123/balance/aep-financials_20250315000327.parquet
2025-03-15 00:03:27,885 - __main__ - INFO - Received event: 0d233228-97da-4741-a786-3201ef5ce7e3 of type update
2025-03-15 00:03:27,890 - __main__ - INFO - Processed event 0d233228-97da-4741-a786-3201ef5ce7e3 of type update
2025-03-15 00:03:34,539 - __main__ - ERROR - Error with Delta processing: Failed to create Spark session
2025-03-15 00:03:34,539 - __main__ - INFO - Falling back to parquet storage
2025-03-15 00:03:34,587 - __main__ - INFO - Saved event data to parquet: ./data/parquet/123/balance/nee-financials_20250315000334.parquet
2025-03-15 00:03:34,588 - __main__ - INFO - Received event: cd593335-fd20-4123-804b-3cb8bc1c0c7e of type update
2025-03-15 00:03:34,593 - __main__ - INFO - Processed event cd593335-fd20-4123-804b-3cb8bc1c0c7e of type update
2025-03-15 00:03:39,330 - __main__ - ERROR - Error with Delta processing: Failed to create Spark session
2025-03-15 00:03:39,331 - __main__ - INFO - Falling back to parquet storage
2025-03-15 00:03:39,401 - __main__ - INFO - Saved event data to parquet: ./data/parquet/123/balance/duk-financials_20250315000339.parquet
2025-03-15 00:03:39,402 - __main__ - INFO - Received event: eb8621b9-e34f-406e-8767-e06e9ce05e56 of type update
2025-03-15 00:03:39,408 - __main__ - INFO - Processed event eb8621b9-e34f-406e-8767-e06e9ce05e56 of type update
2025-03-15 00:03:45,145 - __main__ - ERROR - Error with Delta processing: Failed to create Spark session
2025-03-15 00:03:45,146 - __main__ - INFO - Falling back to parquet storage
2025-03-15 00:03:45,173 - __main__ - INFO - Saved event data to parquet: ./data/parquet/123/balance/ngg-financials_20250315000345.parquet
2025-03-15 00:04:21,269 - __main__ - INFO - Consumer shutting down
2025-03-15 00:04:21,271 - __main__ - INFO - Database connection closed
2025-03-15 00:04:21,277 - kafka.coordinator - INFO - Stopping heartbeat thread
2025-03-15 00:04:21,278 - kafka.coordinator - INFO - Leaving consumer group (cdc-processor).
2025-03-15 00:04:21,288 - kafka.conn - INFO - <BrokerConnection node_id=coordinator-1 host=localhost:9092 <connected> [IPv4 ('127.0.0.1', 9092)]>: Closing connection. 
2025-03-15 00:04:21,290 - kafka.conn - INFO - <BrokerConnection node_id=1 host=localhost:9092 <connected> [IPv4 ('127.0.0.1', 9092)]>: Closing connection. 
2025-03-15 00:04:21,292 - kafka.consumer.fetcher - ERROR - Fetch to node 1 failed: Cancelled: <BrokerConnection node_id=1 host=localhost:9092 <connected> [IPv4 ('127.0.0.1', 9092)]>
2025-03-15 00:04:21,293 - __main__ - INFO - Kafka consumer closed
2025-03-15 00:04:23,831 - kafka.conn - INFO - <BrokerConnection node_id=bootstrap-0 host=localhost:9092 <connecting> [IPv4 ('127.0.0.1', 9092)]>: connecting to localhost:9092 [('127.0.0.1', 9092) IPv4]
2025-03-15 00:04:23,831 - kafka.conn - INFO - Probing node bootstrap-0 broker version
2025-03-15 00:04:23,832 - kafka.conn - INFO - <BrokerConnection node_id=bootstrap-0 host=localhost:9092 <connecting> [IPv4 ('127.0.0.1', 9092)]>: Connection complete.
2025-03-15 00:04:23,935 - kafka.conn - INFO - Broker version identified as 2.6.0
2025-03-15 00:04:23,935 - kafka.conn - INFO - Set configuration api_version=(2, 6, 0) to skip auto check_version requests on startup
2025-03-15 00:04:23,936 - kafka.consumer.subscription_state - INFO - Updating subscribed topics to: ('cdc-events',)
2025-03-15 00:04:23,936 - __main__ - INFO - Connected to Kafka, consuming from topic: cdc-events
2025-03-15 00:04:23,941 - kafka.cluster - INFO - Group coordinator for cdc-processor is BrokerMetadata(nodeId='coordinator-1', host='localhost', port=9092, rack=None)
2025-03-15 00:04:23,942 - kafka.coordinator - INFO - Discovered coordinator coordinator-1 for group cdc-processor
2025-03-15 00:04:23,942 - kafka.coordinator - INFO - Starting new heartbeat thread
2025-03-15 00:04:23,943 - kafka.coordinator.consumer - INFO - Revoking previously assigned partitions set() for group cdc-processor
2025-03-15 00:04:23,944 - kafka.conn - INFO - <BrokerConnection node_id=coordinator-1 host=localhost:9092 <connecting> [IPv4 ('127.0.0.1', 9092)]>: connecting to localhost:9092 [('127.0.0.1', 9092) IPv4]
2025-03-15 00:04:23,945 - kafka.conn - INFO - <BrokerConnection node_id=coordinator-1 host=localhost:9092 <connecting> [IPv4 ('127.0.0.1', 9092)]>: Connection complete.
2025-03-15 00:04:23,946 - kafka.conn - INFO - <BrokerConnection node_id=bootstrap-0 host=localhost:9092 <connected> [IPv4 ('127.0.0.1', 9092)]>: Closing connection. 
2025-03-15 00:04:24,047 - kafka.coordinator - INFO - (Re-)joining group cdc-processor
2025-03-15 00:04:27,050 - kafka.coordinator - INFO - Elected group leader -- performing partition assignments using range
2025-03-15 00:04:27,051 - kafka.conn - INFO - <BrokerConnection node_id=1 host=localhost:9092 <connecting> [IPv4 ('127.0.0.1', 9092)]>: connecting to localhost:9092 [('127.0.0.1', 9092) IPv4]
2025-03-15 00:04:27,052 - kafka.conn - INFO - <BrokerConnection node_id=1 host=localhost:9092 <connecting> [IPv4 ('127.0.0.1', 9092)]>: Connection complete.
2025-03-15 00:04:27,053 - kafka.coordinator - INFO - Successfully joined group cdc-processor with generation 29
2025-03-15 00:04:27,055 - kafka.consumer.subscription_state - INFO - Updated partition assignment: [TopicPartition(topic='cdc-events', partition=0)]
2025-03-15 00:04:27,059 - kafka.coordinator.consumer - INFO - Setting newly assigned partitions {TopicPartition(topic='cdc-events', partition=0)} for group cdc-processor
2025-03-15 00:05:04,928 - __main__ - INFO - Received event: fd8d0c4e-bb1f-4c85-9a53-a94c03e31d26 of type update
2025-03-15 00:05:04,939 - __main__ - INFO - Processed event fd8d0c4e-bb1f-4c85-9a53-a94c03e31d26 of type update
2025-03-15 00:05:17,263 - __main__ - ERROR - Error with Delta processing: Delta table `data/delta/123/balance/delta_table` doesn't exist.
2025-03-15 00:05:17,263 - __main__ - INFO - Falling back to parquet storage
2025-03-15 00:05:17,319 - __main__ - INFO - Saved event data to parquet: ./data/parquet/123/balance/so-financials_20250315000517.parquet
2025-03-15 00:05:17,319 - __main__ - INFO - Received event: cd988751-79ce-4115-a43c-4fb418db43e8 of type update
2025-03-15 00:05:17,328 - __main__ - INFO - Processed event cd988751-79ce-4115-a43c-4fb418db43e8 of type update
2025-03-15 00:05:17,592 - __main__ - ERROR - Error with Delta processing: Delta table `data/delta/123/balance/delta_table` doesn't exist.
2025-03-15 00:05:17,592 - __main__ - INFO - Falling back to parquet storage
2025-03-15 00:05:17,625 - __main__ - INFO - Saved event data to parquet: ./data/parquet/123/balance/aep-financials_20250315000517.parquet
2025-03-15 00:05:17,635 - __main__ - INFO - Received event: f92f66b9-f6aa-44e6-ad33-40f19fe5b13f of type update
2025-03-15 00:05:17,642 - __main__ - INFO - Processed event f92f66b9-f6aa-44e6-ad33-40f19fe5b13f of type update
2025-03-15 00:05:17,878 - __main__ - ERROR - Error with Delta processing: Delta table `data/delta/123/balance/delta_table` doesn't exist.
2025-03-15 00:05:17,878 - __main__ - INFO - Falling back to parquet storage
2025-03-15 00:05:17,907 - __main__ - INFO - Saved event data to parquet: ./data/parquet/123/balance/nee-financials_20250315000517.parquet
2025-03-15 00:05:17,907 - __main__ - INFO - Received event: 2b011add-b130-4c50-80aa-54e9099a4b3b of type update
2025-03-15 00:05:17,912 - __main__ - INFO - Processed event 2b011add-b130-4c50-80aa-54e9099a4b3b of type update
2025-03-15 00:05:18,116 - __main__ - ERROR - Error with Delta processing: Delta table `data/delta/123/balance/delta_table` doesn't exist.
2025-03-15 00:05:18,116 - __main__ - INFO - Falling back to parquet storage
2025-03-15 00:05:18,144 - __main__ - INFO - Saved event data to parquet: ./data/parquet/123/balance/duk-financials_20250315000518.parquet
2025-03-15 00:05:18,144 - __main__ - INFO - Received event: 02f24ba6-e011-46d6-a2e1-27ca3c7bff52 of type update
2025-03-15 00:05:18,147 - __main__ - INFO - Processed event 02f24ba6-e011-46d6-a2e1-27ca3c7bff52 of type update
2025-03-15 00:05:18,354 - __main__ - ERROR - Error with Delta processing: Delta table `data/delta/123/balance/delta_table` doesn't exist.
2025-03-15 00:05:18,354 - __main__ - INFO - Falling back to parquet storage
2025-03-15 00:05:18,380 - __main__ - INFO - Saved event data to parquet: ./data/parquet/123/balance/ngg-financials_20250315000518.parquet
2025-03-15 00:43:26,654 - __main__ - INFO - Consumer shutting down
2025-03-15 00:43:26,677 - __main__ - INFO - Database connection closed
2025-03-15 00:43:26,679 - kafka.coordinator - INFO - Stopping heartbeat thread
2025-03-15 00:43:26,679 - kafka.coordinator - INFO - Leaving consumer group (cdc-processor).
2025-03-15 00:43:26,688 - kafka.conn - INFO - <BrokerConnection node_id=coordinator-1 host=localhost:9092 <connected> [IPv4 ('127.0.0.1', 9092)]>: Closing connection. 
2025-03-15 00:43:26,688 - kafka.conn - INFO - <BrokerConnection node_id=1 host=localhost:9092 <connected> [IPv4 ('127.0.0.1', 9092)]>: Closing connection. 
2025-03-15 00:43:26,689 - kafka.consumer.fetcher - ERROR - Fetch to node 1 failed: Cancelled: <BrokerConnection node_id=1 host=localhost:9092 <connected> [IPv4 ('127.0.0.1', 9092)]>
2025-03-15 00:43:26,689 - __main__ - INFO - Kafka consumer closed
2025-03-15 00:43:26,692 - py4j.clientserver - INFO - Closing down clientserver connection
2025-03-15 00:43:32,438 - kafka.conn - INFO - <BrokerConnection node_id=bootstrap-0 host=localhost:9092 <connecting> [IPv4 ('127.0.0.1', 9092)]>: connecting to localhost:9092 [('127.0.0.1', 9092) IPv4]
2025-03-15 00:43:32,438 - kafka.conn - INFO - Probing node bootstrap-0 broker version
2025-03-15 00:43:32,439 - kafka.conn - INFO - <BrokerConnection node_id=bootstrap-0 host=localhost:9092 <connecting> [IPv4 ('127.0.0.1', 9092)]>: Connection complete.
2025-03-15 00:43:32,542 - kafka.conn - INFO - Broker version identified as 2.6.0
2025-03-15 00:43:32,542 - kafka.conn - INFO - Set configuration api_version=(2, 6, 0) to skip auto check_version requests on startup
2025-03-15 00:43:32,543 - kafka.consumer.subscription_state - INFO - Updating subscribed topics to: ('cdc-events',)
2025-03-15 00:43:32,543 - __main__ - INFO - Connected to Kafka, consuming from topic: cdc-events
2025-03-15 00:43:32,546 - kafka.cluster - INFO - Group coordinator for cdc-processor is BrokerMetadata(nodeId='coordinator-1', host='localhost', port=9092, rack=None)
2025-03-15 00:43:32,547 - kafka.coordinator - INFO - Discovered coordinator coordinator-1 for group cdc-processor
2025-03-15 00:43:32,547 - kafka.coordinator - INFO - Starting new heartbeat thread
2025-03-15 00:43:32,548 - kafka.coordinator.consumer - INFO - Revoking previously assigned partitions set() for group cdc-processor
2025-03-15 00:43:32,548 - kafka.conn - INFO - <BrokerConnection node_id=coordinator-1 host=localhost:9092 <connecting> [IPv4 ('127.0.0.1', 9092)]>: connecting to localhost:9092 [('127.0.0.1', 9092) IPv4]
2025-03-15 00:43:32,549 - kafka.conn - INFO - <BrokerConnection node_id=coordinator-1 host=localhost:9092 <connecting> [IPv4 ('127.0.0.1', 9092)]>: Connection complete.
2025-03-15 00:43:32,550 - kafka.conn - INFO - <BrokerConnection node_id=bootstrap-0 host=localhost:9092 <connected> [IPv4 ('127.0.0.1', 9092)]>: Closing connection. 
2025-03-15 00:43:32,651 - kafka.coordinator - INFO - (Re-)joining group cdc-processor
2025-03-15 00:43:35,669 - kafka.coordinator - INFO - Elected group leader -- performing partition assignments using range
2025-03-15 00:43:35,670 - kafka.conn - INFO - <BrokerConnection node_id=1 host=localhost:9092 <connecting> [IPv4 ('127.0.0.1', 9092)]>: connecting to localhost:9092 [('127.0.0.1', 9092) IPv4]
2025-03-15 00:43:35,671 - kafka.conn - INFO - <BrokerConnection node_id=1 host=localhost:9092 <connecting> [IPv4 ('127.0.0.1', 9092)]>: Connection complete.
2025-03-15 00:43:35,676 - kafka.coordinator - INFO - Successfully joined group cdc-processor with generation 31
2025-03-15 00:43:35,676 - kafka.consumer.subscription_state - INFO - Updated partition assignment: [TopicPartition(topic='cdc-events', partition=0)]
2025-03-15 00:43:35,677 - kafka.coordinator.consumer - INFO - Setting newly assigned partitions {TopicPartition(topic='cdc-events', partition=0)} for group cdc-processor
2025-03-15 00:44:22,491 - __main__ - INFO - Received event: ceacdca4-f88b-493e-a27e-2989c8a8c8cc of type update
2025-03-15 00:44:22,521 - __main__ - INFO - Processed event ceacdca4-f88b-493e-a27e-2989c8a8c8cc of type update
2025-03-15 00:45:06,250 - __main__ - INFO - Successfully created/updated Delta table for 123/balance
2025-03-15 00:45:06,253 - __main__ - INFO - Received event: 0cabe715-5f76-448b-8ecc-87e5de8e9ebf of type update
2025-03-15 00:45:06,267 - __main__ - INFO - Processed event 0cabe715-5f76-448b-8ecc-87e5de8e9ebf of type update
2025-03-15 00:45:23,987 - __main__ - INFO - Successfully created/updated Delta table for 123/balance
2025-03-15 00:45:23,989 - __main__ - INFO - Received event: d8b9e8d2-14f5-445a-b6b5-8c2c82ba2a81 of type update
2025-03-15 00:45:24,003 - __main__ - INFO - Processed event d8b9e8d2-14f5-445a-b6b5-8c2c82ba2a81 of type update
2025-03-15 00:45:38,640 - __main__ - INFO - Successfully created/updated Delta table for 123/balance
2025-03-15 00:45:38,643 - __main__ - INFO - Received event: 2330a0cf-fbef-40a6-aa5b-ac29acb8ec5a of type update
2025-03-15 00:45:38,657 - __main__ - INFO - Processed event 2330a0cf-fbef-40a6-aa5b-ac29acb8ec5a of type update
2025-03-15 00:45:53,852 - __main__ - INFO - Successfully created/updated Delta table for 123/balance
2025-03-15 00:45:53,855 - __main__ - INFO - Received event: 2e0b4a6e-ebab-400c-be84-b22bf750a1d4 of type update
2025-03-15 00:45:53,862 - __main__ - INFO - Processed event 2e0b4a6e-ebab-400c-be84-b22bf750a1d4 of type update
2025-03-15 00:46:07,298 - __main__ - INFO - Successfully created/updated Delta table for 123/balance
2025-03-15 01:41:41,587 - __main__ - INFO - Consumer shutting down
2025-03-15 01:41:41,611 - __main__ - INFO - Database connection closed
2025-03-15 01:41:41,613 - kafka.coordinator - INFO - Stopping heartbeat thread
2025-03-15 01:41:41,614 - kafka.coordinator - INFO - Leaving consumer group (cdc-processor).
2025-03-15 01:41:41,617 - kafka.conn - INFO - <BrokerConnection node_id=coordinator-1 host=localhost:9092 <connected> [IPv4 ('127.0.0.1', 9092)]>: Closing connection. 
2025-03-15 01:41:41,618 - kafka.conn - INFO - <BrokerConnection node_id=1 host=localhost:9092 <connected> [IPv4 ('127.0.0.1', 9092)]>: Closing connection. 
2025-03-15 01:41:41,618 - kafka.consumer.fetcher - ERROR - Fetch to node 1 failed: Cancelled: <BrokerConnection node_id=1 host=localhost:9092 <connected> [IPv4 ('127.0.0.1', 9092)]>
2025-03-15 01:41:41,618 - __main__ - INFO - Kafka consumer closed
2025-03-15 01:41:41,621 - py4j.clientserver - INFO - Closing down clientserver connection
2025-03-15 01:41:44,148 - kafka.conn - INFO - <BrokerConnection node_id=bootstrap-0 host=localhost:9092 <connecting> [IPv4 ('127.0.0.1', 9092)]>: connecting to localhost:9092 [('127.0.0.1', 9092) IPv4]
2025-03-15 01:41:44,149 - kafka.conn - INFO - Probing node bootstrap-0 broker version
2025-03-15 01:41:44,151 - kafka.conn - INFO - <BrokerConnection node_id=bootstrap-0 host=localhost:9092 <connecting> [IPv4 ('127.0.0.1', 9092)]>: Connection complete.
2025-03-15 01:41:44,256 - kafka.conn - INFO - Broker version identified as 2.6.0
2025-03-15 01:41:44,256 - kafka.conn - INFO - Set configuration api_version=(2, 6, 0) to skip auto check_version requests on startup
2025-03-15 01:41:44,257 - kafka.consumer.subscription_state - INFO - Updating subscribed topics to: ('cdc-events',)
2025-03-15 01:41:44,257 - __main__ - INFO - Connected to Kafka, consuming from topic: cdc-events
2025-03-15 01:41:44,261 - kafka.cluster - INFO - Group coordinator for cdc-processor is BrokerMetadata(nodeId='coordinator-1', host='localhost', port=9092, rack=None)
2025-03-15 01:41:44,261 - kafka.coordinator - INFO - Discovered coordinator coordinator-1 for group cdc-processor
2025-03-15 01:41:44,262 - kafka.coordinator - INFO - Starting new heartbeat thread
2025-03-15 01:41:44,263 - kafka.coordinator.consumer - INFO - Revoking previously assigned partitions set() for group cdc-processor
2025-03-15 01:41:44,263 - kafka.conn - INFO - <BrokerConnection node_id=coordinator-1 host=localhost:9092 <connecting> [IPv4 ('127.0.0.1', 9092)]>: connecting to localhost:9092 [('127.0.0.1', 9092) IPv4]
2025-03-15 01:41:44,264 - kafka.conn - INFO - <BrokerConnection node_id=coordinator-1 host=localhost:9092 <connecting> [IPv4 ('127.0.0.1', 9092)]>: Connection complete.
2025-03-15 01:41:44,265 - kafka.conn - INFO - <BrokerConnection node_id=bootstrap-0 host=localhost:9092 <connected> [IPv4 ('127.0.0.1', 9092)]>: Closing connection. 
2025-03-15 01:41:44,366 - kafka.coordinator - INFO - (Re-)joining group cdc-processor
2025-03-15 01:41:47,373 - kafka.coordinator - INFO - Elected group leader -- performing partition assignments using range
2025-03-15 01:41:47,375 - kafka.conn - INFO - <BrokerConnection node_id=1 host=localhost:9092 <connecting> [IPv4 ('127.0.0.1', 9092)]>: connecting to localhost:9092 [('127.0.0.1', 9092) IPv4]
2025-03-15 01:41:47,382 - kafka.conn - INFO - <BrokerConnection node_id=1 host=localhost:9092 <connecting> [IPv4 ('127.0.0.1', 9092)]>: Connection complete.
2025-03-15 01:41:47,383 - kafka.coordinator - INFO - Successfully joined group cdc-processor with generation 33
2025-03-15 01:41:47,384 - kafka.consumer.subscription_state - INFO - Updated partition assignment: [TopicPartition(topic='cdc-events', partition=0)]
2025-03-15 01:41:47,385 - kafka.coordinator.consumer - INFO - Setting newly assigned partitions {TopicPartition(topic='cdc-events', partition=0)} for group cdc-processor
2025-03-15 01:42:46,261 - __main__ - INFO - Received event: 62febde1-daf2-460a-bf5d-3e415e5019b5 of type update
2025-03-15 01:42:46,327 - __main__ - INFO - Processed event 62febde1-daf2-460a-bf5d-3e415e5019b5 of type update
2025-03-15 01:42:46,328 - __main__ - INFO - Azure Data Lake storage is disabled. Falling back to local Delta Lake processing.
2025-03-15 01:44:03,230 - py4j.clientserver - INFO - Error while receiving.
Traceback (most recent call last):
  File "/home/muhammadadil/.virtualenvs/myenv/lib/python3.12/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
                          ^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: reentrant call inside <_io.BufferedReader name=10>
2025-03-15 01:44:03,239 - py4j.clientserver - INFO - Closing down clientserver connection
2025-03-15 01:44:03,240 - root - ERROR - Exception while sending command.
Traceback (most recent call last):
  File "/home/muhammadadil/.virtualenvs/myenv/lib/python3.12/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
                          ^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: reentrant call inside <_io.BufferedReader name=10>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/muhammadadil/.virtualenvs/myenv/lib/python3.12/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/muhammadadil/.virtualenvs/myenv/lib/python3.12/site-packages/py4j/clientserver.py", line 539, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
2025-03-15 01:44:03,252 - py4j.clientserver - INFO - Error while receiving.
Traceback (most recent call last):
  File "/home/muhammadadil/.virtualenvs/myenv/lib/python3.12/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
                          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socket.py", line 720, in readinto
    return self._sock.recv_into(b)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/muhammadadil/.virtualenvs/myenv/lib/python3.12/site-packages/pyspark/context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "/home/muhammadadil/.virtualenvs/myenv/lib/python3.12/site-packages/pyspark/context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
    ^^^^^^^^^^^^^^
  File "/home/muhammadadil/.virtualenvs/myenv/lib/python3.12/site-packages/py4j/java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
                   ^^^^^^^^^^^^^^^^^
  File "/home/muhammadadil/.virtualenvs/myenv/lib/python3.12/site-packages/pyspark/errors/exceptions/captured.py", line 169, in deco
    return f(*a, **kw)
           ^^^^^^^^^^^
  File "/home/muhammadadil/.virtualenvs/myenv/lib/python3.12/site-packages/py4j/protocol.py", line 334, in get_return_value
    raise Py4JError(
py4j.protocol.Py4JError: An error occurred while calling o22.sc
2025-03-15 01:44:03,262 - py4j.clientserver - INFO - Closing down clientserver connection
2025-03-15 01:44:03,263 - root - ERROR - Exception while sending command.
Traceback (most recent call last):
  File "/home/muhammadadil/.virtualenvs/myenv/lib/python3.12/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
                          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socket.py", line 720, in readinto
    return self._sock.recv_into(b)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/muhammadadil/.virtualenvs/myenv/lib/python3.12/site-packages/pyspark/context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "/home/muhammadadil/.virtualenvs/myenv/lib/python3.12/site-packages/pyspark/context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
    ^^^^^^^^^^^^^^
  File "/home/muhammadadil/.virtualenvs/myenv/lib/python3.12/site-packages/py4j/java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
                   ^^^^^^^^^^^^^^^^^
  File "/home/muhammadadil/.virtualenvs/myenv/lib/python3.12/site-packages/pyspark/errors/exceptions/captured.py", line 169, in deco
    return f(*a, **kw)
           ^^^^^^^^^^^
  File "/home/muhammadadil/.virtualenvs/myenv/lib/python3.12/site-packages/py4j/protocol.py", line 334, in get_return_value
    raise Py4JError(
py4j.protocol.Py4JError: An error occurred while calling o22.sc

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/muhammadadil/.virtualenvs/myenv/lib/python3.12/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/muhammadadil/.virtualenvs/myenv/lib/python3.12/site-packages/py4j/clientserver.py", line 539, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
2025-03-15 01:44:03,264 - py4j.clientserver - INFO - Closing down clientserver connection
2025-03-15 01:44:03,267 - __main__ - INFO - Successfully created/updated Delta table for 123/balance
2025-03-15 01:44:03,282 - __main__ - INFO - Received event: b91bcf20-0ca0-43c3-bf33-8b26af429736 of type update
2025-03-15 01:44:03,304 - __main__ - INFO - Processed event b91bcf20-0ca0-43c3-bf33-8b26af429736 of type update
2025-03-15 01:44:03,305 - __main__ - INFO - Azure Data Lake storage is disabled. Falling back to local Delta Lake processing.
2025-03-15 01:44:04,102 - py4j.clientserver - INFO - Error while receiving.
Traceback (most recent call last):
  File "/home/muhammadadil/.virtualenvs/myenv/lib/python3.12/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
                          ^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: reentrant call inside <_io.BufferedReader name=10>
2025-03-15 01:44:04,103 - py4j.clientserver - INFO - Closing down clientserver connection
2025-03-15 01:44:04,104 - root - ERROR - Exception while sending command.
Traceback (most recent call last):
  File "/home/muhammadadil/.virtualenvs/myenv/lib/python3.12/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
                          ^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: reentrant call inside <_io.BufferedReader name=10>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/muhammadadil/.virtualenvs/myenv/lib/python3.12/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/muhammadadil/.virtualenvs/myenv/lib/python3.12/site-packages/py4j/clientserver.py", line 539, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
2025-03-15 01:44:04,104 - py4j.clientserver - INFO - Error while receiving.
Traceback (most recent call last):
  File "/home/muhammadadil/.virtualenvs/myenv/lib/python3.12/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
                          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socket.py", line 720, in readinto
    return self._sock.recv_into(b)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/muhammadadil/.virtualenvs/myenv/lib/python3.12/site-packages/pyspark/context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "/home/muhammadadil/.virtualenvs/myenv/lib/python3.12/site-packages/pyspark/context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
    ^^^^^^^^^^^^^^
  File "/home/muhammadadil/.virtualenvs/myenv/lib/python3.12/site-packages/py4j/java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
                   ^^^^^^^^^^^^^^^^^
  File "/home/muhammadadil/.virtualenvs/myenv/lib/python3.12/site-packages/pyspark/errors/exceptions/captured.py", line 169, in deco
    return f(*a, **kw)
           ^^^^^^^^^^^
  File "/home/muhammadadil/.virtualenvs/myenv/lib/python3.12/site-packages/py4j/protocol.py", line 334, in get_return_value
    raise Py4JError(
py4j.protocol.Py4JError: An error occurred while calling o22.sc
2025-03-15 01:44:04,112 - py4j.clientserver - INFO - Closing down clientserver connection
2025-03-15 01:44:04,113 - root - ERROR - Exception while sending command.
Traceback (most recent call last):
  File "/home/muhammadadil/.virtualenvs/myenv/lib/python3.12/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
                          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socket.py", line 720, in readinto
    return self._sock.recv_into(b)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/muhammadadil/.virtualenvs/myenv/lib/python3.12/site-packages/pyspark/context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "/home/muhammadadil/.virtualenvs/myenv/lib/python3.12/site-packages/pyspark/context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
    ^^^^^^^^^^^^^^
  File "/home/muhammadadil/.virtualenvs/myenv/lib/python3.12/site-packages/py4j/java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
                   ^^^^^^^^^^^^^^^^^
  File "/home/muhammadadil/.virtualenvs/myenv/lib/python3.12/site-packages/pyspark/errors/exceptions/captured.py", line 169, in deco
    return f(*a, **kw)
           ^^^^^^^^^^^
  File "/home/muhammadadil/.virtualenvs/myenv/lib/python3.12/site-packages/py4j/protocol.py", line 334, in get_return_value
    raise Py4JError(
py4j.protocol.Py4JError: An error occurred while calling o22.sc

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/muhammadadil/.virtualenvs/myenv/lib/python3.12/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/muhammadadil/.virtualenvs/myenv/lib/python3.12/site-packages/py4j/clientserver.py", line 539, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
2025-03-15 01:44:04,119 - py4j.clientserver - INFO - Closing down clientserver connection
2025-03-15 01:44:04,119 - __main__ - ERROR - Error with Delta processing: An error occurred while calling o108.update
2025-03-15 01:44:04,120 - __main__ - INFO - Falling back to parquet storage
2025-03-15 01:44:04,267 - __main__ - INFO - Saved event data to parquet: ./data/parquet/123/balance/aep-financials_20250315014404.parquet
2025-03-15 01:44:04,270 - __main__ - INFO - Received event: 3be01c64-7235-4356-9546-c74669cf9f5a of type update
2025-03-15 01:44:04,288 - __main__ - INFO - Processed event 3be01c64-7235-4356-9546-c74669cf9f5a of type update
2025-03-15 01:44:04,289 - __main__ - INFO - Azure Data Lake storage is disabled. Falling back to local Delta Lake processing.
2025-03-15 01:44:04,600 - py4j.clientserver - INFO - Error while receiving.
Traceback (most recent call last):
  File "/home/muhammadadil/.virtualenvs/myenv/lib/python3.12/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
                          ^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: reentrant call inside <_io.BufferedReader name=10>
2025-03-15 01:44:04,603 - py4j.clientserver - INFO - Closing down clientserver connection
2025-03-15 01:44:04,604 - root - ERROR - Exception while sending command.
Traceback (most recent call last):
  File "/home/muhammadadil/.virtualenvs/myenv/lib/python3.12/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
                          ^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: reentrant call inside <_io.BufferedReader name=10>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/muhammadadil/.virtualenvs/myenv/lib/python3.12/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/muhammadadil/.virtualenvs/myenv/lib/python3.12/site-packages/py4j/clientserver.py", line 539, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
2025-03-15 01:44:04,607 - py4j.clientserver - INFO - Error while receiving.
Traceback (most recent call last):
  File "/home/muhammadadil/.virtualenvs/myenv/lib/python3.12/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
                          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socket.py", line 720, in readinto
    return self._sock.recv_into(b)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/muhammadadil/.virtualenvs/myenv/lib/python3.12/site-packages/pyspark/context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "/home/muhammadadil/.virtualenvs/myenv/lib/python3.12/site-packages/pyspark/context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
    ^^^^^^^^^^^^^^
  File "/home/muhammadadil/.virtualenvs/myenv/lib/python3.12/site-packages/py4j/java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
                   ^^^^^^^^^^^^^^^^^
  File "/home/muhammadadil/.virtualenvs/myenv/lib/python3.12/site-packages/pyspark/errors/exceptions/captured.py", line 169, in deco
    return f(*a, **kw)
           ^^^^^^^^^^^
  File "/home/muhammadadil/.virtualenvs/myenv/lib/python3.12/site-packages/py4j/protocol.py", line 334, in get_return_value
    raise Py4JError(
py4j.protocol.Py4JError: An error occurred while calling o22.sc
2025-03-15 01:44:04,608 - py4j.clientserver - INFO - Closing down clientserver connection
2025-03-15 01:44:04,608 - root - ERROR - Exception while sending command.
Traceback (most recent call last):
  File "/home/muhammadadil/.virtualenvs/myenv/lib/python3.12/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
                          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socket.py", line 720, in readinto
    return self._sock.recv_into(b)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/muhammadadil/.virtualenvs/myenv/lib/python3.12/site-packages/pyspark/context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "/home/muhammadadil/.virtualenvs/myenv/lib/python3.12/site-packages/pyspark/context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
    ^^^^^^^^^^^^^^
  File "/home/muhammadadil/.virtualenvs/myenv/lib/python3.12/site-packages/py4j/java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
                   ^^^^^^^^^^^^^^^^^
  File "/home/muhammadadil/.virtualenvs/myenv/lib/python3.12/site-packages/pyspark/errors/exceptions/captured.py", line 169, in deco
    return f(*a, **kw)
           ^^^^^^^^^^^
  File "/home/muhammadadil/.virtualenvs/myenv/lib/python3.12/site-packages/py4j/protocol.py", line 334, in get_return_value
    raise Py4JError(
py4j.protocol.Py4JError: An error occurred while calling o22.sc

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/muhammadadil/.virtualenvs/myenv/lib/python3.12/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/muhammadadil/.virtualenvs/myenv/lib/python3.12/site-packages/py4j/clientserver.py", line 539, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
2025-03-15 01:44:04,610 - py4j.clientserver - INFO - Closing down clientserver connection
2025-03-15 01:44:04,610 - __main__ - ERROR - Error with Delta processing: An error occurred while calling o137.update
2025-03-15 01:44:04,610 - __main__ - INFO - Falling back to parquet storage
2025-03-15 01:44:04,662 - __main__ - INFO - Saved event data to parquet: ./data/parquet/123/balance/nee-financials_20250315014404.parquet
2025-03-15 01:44:04,664 - __main__ - INFO - Received event: a3a38714-90b4-4733-a2cd-04324db8fe7e of type update
2025-03-15 01:44:04,674 - __main__ - INFO - Processed event a3a38714-90b4-4733-a2cd-04324db8fe7e of type update
2025-03-15 01:44:04,674 - __main__ - INFO - Azure Data Lake storage is disabled. Falling back to local Delta Lake processing.
2025-03-15 01:44:06,072 - py4j.clientserver - INFO - Error while receiving.
Traceback (most recent call last):
  File "/home/muhammadadil/.virtualenvs/myenv/lib/python3.12/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
                          ^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: reentrant call inside <_io.BufferedReader name=10>
2025-03-15 01:44:06,075 - py4j.clientserver - INFO - Closing down clientserver connection
2025-03-15 01:44:06,075 - root - ERROR - Exception while sending command.
Traceback (most recent call last):
  File "/home/muhammadadil/.virtualenvs/myenv/lib/python3.12/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
                          ^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: reentrant call inside <_io.BufferedReader name=10>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/muhammadadil/.virtualenvs/myenv/lib/python3.12/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/muhammadadil/.virtualenvs/myenv/lib/python3.12/site-packages/py4j/clientserver.py", line 539, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
2025-03-15 01:44:06,077 - py4j.clientserver - INFO - Error while receiving.
Traceback (most recent call last):
  File "/home/muhammadadil/.virtualenvs/myenv/lib/python3.12/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
                          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socket.py", line 720, in readinto
    return self._sock.recv_into(b)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/muhammadadil/.virtualenvs/myenv/lib/python3.12/site-packages/pyspark/context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "/home/muhammadadil/.virtualenvs/myenv/lib/python3.12/site-packages/pyspark/context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
    ^^^^^^^^^^^^^^
  File "/home/muhammadadil/.virtualenvs/myenv/lib/python3.12/site-packages/py4j/java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
                   ^^^^^^^^^^^^^^^^^
  File "/home/muhammadadil/.virtualenvs/myenv/lib/python3.12/site-packages/pyspark/errors/exceptions/captured.py", line 169, in deco
    return f(*a, **kw)
           ^^^^^^^^^^^
  File "/home/muhammadadil/.virtualenvs/myenv/lib/python3.12/site-packages/py4j/protocol.py", line 334, in get_return_value
    raise Py4JError(
py4j.protocol.Py4JError: An error occurred while calling o22.sc
2025-03-15 01:44:06,079 - py4j.clientserver - INFO - Closing down clientserver connection
2025-03-15 01:44:06,080 - root - ERROR - Exception while sending command.
Traceback (most recent call last):
  File "/home/muhammadadil/.virtualenvs/myenv/lib/python3.12/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
                          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socket.py", line 720, in readinto
    return self._sock.recv_into(b)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/muhammadadil/.virtualenvs/myenv/lib/python3.12/site-packages/pyspark/context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "/home/muhammadadil/.virtualenvs/myenv/lib/python3.12/site-packages/pyspark/context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
    ^^^^^^^^^^^^^^
  File "/home/muhammadadil/.virtualenvs/myenv/lib/python3.12/site-packages/py4j/java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
                   ^^^^^^^^^^^^^^^^^
  File "/home/muhammadadil/.virtualenvs/myenv/lib/python3.12/site-packages/pyspark/errors/exceptions/captured.py", line 169, in deco
    return f(*a, **kw)
           ^^^^^^^^^^^
  File "/home/muhammadadil/.virtualenvs/myenv/lib/python3.12/site-packages/py4j/protocol.py", line 334, in get_return_value
    raise Py4JError(
py4j.protocol.Py4JError: An error occurred while calling o22.sc

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/muhammadadil/.virtualenvs/myenv/lib/python3.12/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/muhammadadil/.virtualenvs/myenv/lib/python3.12/site-packages/py4j/clientserver.py", line 539, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
2025-03-15 01:44:06,082 - py4j.clientserver - INFO - Closing down clientserver connection
2025-03-15 01:44:06,083 - __main__ - ERROR - Error with Delta processing: An error occurred while calling o166.update
2025-03-15 01:44:06,083 - __main__ - INFO - Falling back to parquet storage
2025-03-15 01:44:06,170 - __main__ - INFO - Saved event data to parquet: ./data/parquet/123/balance/duk-financials_20250315014406.parquet
2025-03-15 01:44:06,172 - __main__ - INFO - Received event: 0240daf4-c795-46d1-8d24-4f9455125f7c of type update
2025-03-15 01:44:06,177 - __main__ - INFO - Processed event 0240daf4-c795-46d1-8d24-4f9455125f7c of type update
2025-03-15 01:44:06,179 - __main__ - INFO - Azure Data Lake storage is disabled. Falling back to local Delta Lake processing.
2025-03-15 01:44:06,900 - py4j.clientserver - INFO - Error while receiving.
Traceback (most recent call last):
  File "/home/muhammadadil/.virtualenvs/myenv/lib/python3.12/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
                          ^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: reentrant call inside <_io.BufferedReader name=10>
2025-03-15 01:44:06,902 - py4j.clientserver - INFO - Closing down clientserver connection
2025-03-15 01:44:06,905 - root - ERROR - Exception while sending command.
Traceback (most recent call last):
  File "/home/muhammadadil/.virtualenvs/myenv/lib/python3.12/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
                          ^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: reentrant call inside <_io.BufferedReader name=10>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/muhammadadil/.virtualenvs/myenv/lib/python3.12/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/muhammadadil/.virtualenvs/myenv/lib/python3.12/site-packages/py4j/clientserver.py", line 539, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
2025-03-15 01:44:06,909 - py4j.clientserver - INFO - Error while receiving.
Traceback (most recent call last):
  File "/home/muhammadadil/.virtualenvs/myenv/lib/python3.12/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
                          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socket.py", line 720, in readinto
    return self._sock.recv_into(b)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/muhammadadil/.virtualenvs/myenv/lib/python3.12/site-packages/pyspark/context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "/home/muhammadadil/.virtualenvs/myenv/lib/python3.12/site-packages/pyspark/context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
    ^^^^^^^^^^^^^^
  File "/home/muhammadadil/.virtualenvs/myenv/lib/python3.12/site-packages/py4j/java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
                   ^^^^^^^^^^^^^^^^^
  File "/home/muhammadadil/.virtualenvs/myenv/lib/python3.12/site-packages/pyspark/errors/exceptions/captured.py", line 169, in deco
    return f(*a, **kw)
           ^^^^^^^^^^^
  File "/home/muhammadadil/.virtualenvs/myenv/lib/python3.12/site-packages/py4j/protocol.py", line 334, in get_return_value
    raise Py4JError(
py4j.protocol.Py4JError: An error occurred while calling o22.sc
2025-03-15 01:44:06,914 - py4j.clientserver - INFO - Closing down clientserver connection
2025-03-15 01:44:06,914 - root - ERROR - Exception while sending command.
Traceback (most recent call last):
  File "/home/muhammadadil/.virtualenvs/myenv/lib/python3.12/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
                          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socket.py", line 720, in readinto
    return self._sock.recv_into(b)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/muhammadadil/.virtualenvs/myenv/lib/python3.12/site-packages/pyspark/context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "/home/muhammadadil/.virtualenvs/myenv/lib/python3.12/site-packages/pyspark/context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
    ^^^^^^^^^^^^^^
  File "/home/muhammadadil/.virtualenvs/myenv/lib/python3.12/site-packages/py4j/java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
                   ^^^^^^^^^^^^^^^^^
  File "/home/muhammadadil/.virtualenvs/myenv/lib/python3.12/site-packages/pyspark/errors/exceptions/captured.py", line 169, in deco
    return f(*a, **kw)
           ^^^^^^^^^^^
  File "/home/muhammadadil/.virtualenvs/myenv/lib/python3.12/site-packages/py4j/protocol.py", line 334, in get_return_value
    raise Py4JError(
py4j.protocol.Py4JError: An error occurred while calling o22.sc

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/muhammadadil/.virtualenvs/myenv/lib/python3.12/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/muhammadadil/.virtualenvs/myenv/lib/python3.12/site-packages/py4j/clientserver.py", line 539, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
2025-03-15 01:44:06,918 - py4j.clientserver - INFO - Closing down clientserver connection
2025-03-15 01:44:06,918 - __main__ - ERROR - Error with Delta processing: An error occurred while calling o195.update
2025-03-15 01:44:06,919 - __main__ - INFO - Falling back to parquet storage
2025-03-15 01:44:06,974 - __main__ - INFO - Saved event data to parquet: ./data/parquet/123/balance/ngg-financials_20250315014406.parquet
2025-03-15 01:45:07,699 - __main__ - INFO - Consumer shutting down
2025-03-15 01:45:07,718 - __main__ - INFO - Database connection closed
2025-03-15 01:45:07,720 - kafka.coordinator - INFO - Stopping heartbeat thread
2025-03-15 01:45:07,720 - kafka.coordinator - INFO - Leaving consumer group (cdc-processor).
2025-03-15 01:45:07,723 - kafka.conn - INFO - <BrokerConnection node_id=coordinator-1 host=localhost:9092 <connected> [IPv4 ('127.0.0.1', 9092)]>: Closing connection. 
2025-03-15 01:45:07,724 - kafka.conn - INFO - <BrokerConnection node_id=1 host=localhost:9092 <connected> [IPv4 ('127.0.0.1', 9092)]>: Closing connection. 
2025-03-15 01:45:07,724 - kafka.consumer.fetcher - ERROR - Fetch to node 1 failed: Cancelled: <BrokerConnection node_id=1 host=localhost:9092 <connected> [IPv4 ('127.0.0.1', 9092)]>
2025-03-15 01:45:07,724 - __main__ - INFO - Kafka consumer closed
2025-03-15 01:45:07,729 - py4j.clientserver - INFO - Closing down clientserver connection
